==Query: 1SELECT *ÊFROM surveyÊLIMIT 10;==Query: 2SELECT question, COUNT (DISTINCT(user_id))ÊFROM surveyÊGROUP BY 1;==Query: 3SELECT question, COUNT (DISTINCT(user_id))ÊFROM surveyÊGROUP BY 1;==Query: 4 ÊSELECT *ÊFROM quizÊLIMIT 5;ÊSELECT *ÊFROM home_try_onÊLIMIT 5;ÊSELECT *ÊFROM purchaseÊLIMIT 5;==Query: 5ÊWITH FUNNEL AS (SELECT DISTINCT q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'ÊFROM quiz as 'q'ÊLEFT JOIN home_try_on as 'h' ON q.user_id=h.user_idÊLEFT JOIN purchase as 'p'Êon p.user_id = h.user_id)ÊSELECT user_id, (CASE WHEN is_home_try_on = 1 THEN 'TRUE' ELSE 'FALSE' END) as is_home_try_on, (CASE WHEN number_of_pairs IS NULL THEN 'NULL' ELSE number_of_pairs END) AS number_of_pairs, (CASE WHEN is_purchase =1 THEN 'TRUE' ELSE 'FALSE' END ) as is_purchaseÊFROM FUNNELÊLIMIT 10==Query:6WITH FUNNEL AS (SELECT DISTINCT q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'ÊFROM quiz as 'q'ÊLEFT JOIN home_try_on as 'h' ON q.user_id=h.user_idÊLEFT JOIN purchase as 'p'Êon p.user_id = h.user_id)ÊSELECT COUNT (*) AS 'quiz_takers', SUM(is_home_try_on) as 'home_try_on',SUM(is_purchase) as 'purchased',Ê1.0 * SUM(is_home_try_on)/COUNT (user_id) as 'browse_to_try_on', 1.0*SUM(is_purchase)/SUM(is_home_try_on) as 'try_on_to_checkout'ÊFROM FUNNELÊ;==Query:7WITH FUNNEL AS (SELECT DISTINCT q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'ÊFROM quiz as 'q'ÊLEFT JOIN home_try_on as 'h' ON q.user_id=h.user_idÊLEFT JOIN purchase as 'p'Êon p.user_id = h.user_id)SELECT SUM (CASE WHEN number_of_pairs ='3 pairs' THEN is_home_try_on ELSE null END) AS 'tried on 3 pairs', SUM ( CASE WHEN number_of_pairs = '5 pairs' THEN is_home_try_on ELSE null END) AS 'tried on 5 pairs', SUM (CASE WHEN number_of_pairs = '3 pairs' THEN is_purchase ELSE null END) AS 'tried on 3 and purchased', SUM ( CASE WHEN number_of_pairs = '5 pairs' THEN is_purchase ELSE null END) AS 'tried on 5 and purchased'ÊFROM FUNNELÊ;==Query:8WITH FUNNEL AS (SELECT DISTINCT q.user_id,p.style,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'ÊFROM quiz as 'q'ÊLEFT JOIN home_try_on as 'h' ON q.user_id=h.user_idÊLEFT JOIN purchase as 'p'Êon p.user_id = h.user_id)SELECT SUM (CASE WHEN style like 'Women%' then is_purchase ELSE null end) as 'Purchased Women', SUM (CASE WHEN style like 'Men%' then is_purchase ELSE null END)ÊAS 'Purchased Men'ÊFROM FUNNELÊ;